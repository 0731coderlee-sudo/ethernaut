{"abi":[{"type":"constructor","inputs":[{"name":"_target","type":"address","internalType":"address payable"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"getBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"target","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address payable"}],"stateMutability":"view"}],"bytecode":{"object":"0x608060405234801561000f575f5ffd5b5060405161055f38038061055f83398181016040528101906100319190610114565b335f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508060015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505061013f565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100e3826100ba565b9050919050565b6100f3816100d9565b81146100fd575f5ffd5b50565b5f8151905061010e816100ea565b92915050565b5f60208284031215610129576101286100b6565b5b5f61013684828501610100565b91505092915050565b6104138061014c5f395ff3fe608060405260043610610042575f3560e01c806312065fe01461004d5780638da5cb5b146100775780639e5faafc146100a1578063d4b83992146100b757610049565b3661004957005b5f5ffd5b348015610058575f5ffd5b506100616100e1565b60405161006e9190610253565b60405180910390f35b348015610082575f5ffd5b5061008b6100e8565b60405161009891906102ab565b60405180910390f35b3480156100ac575f5ffd5b506100b561010c565b005b3480156100c2575f5ffd5b506100cb610216565b6040516100d891906102e4565b60405180910390f35b5f47905090565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461019a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161019190610357565b60405180910390fd5b5f47116101dc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101d3906103bf565b60405180910390fd5b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f819050919050565b61024d8161023b565b82525050565b5f6020820190506102665f830184610244565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6102958261026c565b9050919050565b6102a58161028b565b82525050565b5f6020820190506102be5f83018461029c565b92915050565b5f6102ce8261026c565b9050919050565b6102de816102c4565b82525050565b5f6020820190506102f75f8301846102d5565b92915050565b5f82825260208201905092915050565b7f4f6e6c79206f776e6572000000000000000000000000000000000000000000005f82015250565b5f610341600a836102fd565b915061034c8261030d565b602082019050919050565b5f6020820190508181035f83015261036e81610335565b9050919050565b7f4e6f2045544820746f2073656e640000000000000000000000000000000000005f82015250565b5f6103a9600e836102fd565b91506103b482610375565b602082019050919050565b5f6020820190508181035f8301526103d68161039d565b905091905056fea264697066735822122079734dacd79c39310f5db68845e2a62b4f2847af25d246190f1909b568e014ae64736f6c634300081e0033","sourceMap":"509:1051:28:-:0;;;598:98;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;653:10;645:5;;:18;;;;;;;;;;;;;;;;;;682:7;673:6;;:16;;;;;;;;;;;;;;;;;;598:98;509:1051;;88:117:63;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:104::-;511:7;540:24;558:5;540:24;:::i;:::-;529:35;;466:104;;;:::o;576:138::-;657:32;683:5;657:32;:::i;:::-;650:5;647:43;637:71;;704:1;701;694:12;637:71;576:138;:::o;720:159::-;785:5;816:6;810:13;801:22;;832:41;867:5;832:41;:::i;:::-;720:159;;;;:::o;885:367::-;963:6;1012:2;1000:9;991:7;987:23;983:32;980:119;;;1018:79;;:::i;:::-;980:119;1138:1;1163:72;1227:7;1218:6;1207:9;1203:22;1163:72;:::i;:::-;1153:82;;1109:136;885:367;;;;:::o;509:1051:28:-;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x608060405260043610610042575f3560e01c806312065fe01461004d5780638da5cb5b146100775780639e5faafc146100a1578063d4b83992146100b757610049565b3661004957005b5f5ffd5b348015610058575f5ffd5b506100616100e1565b60405161006e9190610253565b60405180910390f35b348015610082575f5ffd5b5061008b6100e8565b60405161009891906102ab565b60405180910390f35b3480156100ac575f5ffd5b506100b561010c565b005b3480156100c2575f5ffd5b506100cb610216565b6040516100d891906102e4565b60405180910390f35b5f47905090565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461019a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161019190610357565b60405180910390fd5b5f47116101dc576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101d3906103bf565b60405180910390fd5b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16ff5b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f819050919050565b61024d8161023b565b82525050565b5f6020820190506102665f830184610244565b92915050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6102958261026c565b9050919050565b6102a58161028b565b82525050565b5f6020820190506102be5f83018461029c565b92915050565b5f6102ce8261026c565b9050919050565b6102de816102c4565b82525050565b5f6020820190506102f75f8301846102d5565b92915050565b5f82825260208201905092915050565b7f4f6e6c79206f776e6572000000000000000000000000000000000000000000005f82015250565b5f610341600a836102fd565b915061034c8261030d565b602082019050919050565b5f6020820190508181035f83015261036e81610335565b9050919050565b7f4e6f2045544820746f2073656e640000000000000000000000000000000000005f82015250565b5f6103a9600e836102fd565b91506103b482610375565b602082019050919050565b5f6020820190508181035f8301526103d68161039d565b905091905056fea264697066735822122079734dacd79c39310f5db68845e2a62b4f2847af25d246190f1909b568e014ae64736f6c634300081e0033","sourceMap":"509:1051:28:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1459:99;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;536:20;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1101:302;;;;;;;;;;;;;:::i;:::-;;562:29;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1459:99;1504:7;1530:21;1523:28;;1459:99;:::o;536:20::-;;;;;;;;;;;;;:::o;1101:302::-;1160:5;;;;;;;;;;;1146:19;;:10;:19;;;1138:42;;;;;;;;;;;;:::i;:::-;;;;;;;;;1222:1;1198:21;:25;1190:52;;;;;;;;;;;;:::i;:::-;;;;;;;;;1389:6;;;;;;;;;;;1376:20;;;562:29;;;;;;;;;;;;;:::o;7:77:63:-;44:7;73:5;62:16;;7:77;;;:::o;90:118::-;177:24;195:5;177:24;:::i;:::-;172:3;165:37;90:118;;:::o;214:222::-;307:4;345:2;334:9;330:18;322:26;;358:71;426:1;415:9;411:17;402:6;358:71;:::i;:::-;214:222;;;;:::o;442:126::-;479:7;519:42;512:5;508:54;497:65;;442:126;;;:::o;574:96::-;611:7;640:24;658:5;640:24;:::i;:::-;629:35;;574:96;;;:::o;676:118::-;763:24;781:5;763:24;:::i;:::-;758:3;751:37;676:118;;:::o;800:222::-;893:4;931:2;920:9;916:18;908:26;;944:71;1012:1;1001:9;997:17;988:6;944:71;:::i;:::-;800:222;;;;:::o;1028:104::-;1073:7;1102:24;1120:5;1102:24;:::i;:::-;1091:35;;1028:104;;;:::o;1138:142::-;1241:32;1267:5;1241:32;:::i;:::-;1236:3;1229:45;1138:142;;:::o;1286:254::-;1395:4;1433:2;1422:9;1418:18;1410:26;;1446:87;1530:1;1519:9;1515:17;1506:6;1446:87;:::i;:::-;1286:254;;;;:::o;1546:169::-;1630:11;1664:6;1659:3;1652:19;1704:4;1699:3;1695:14;1680:29;;1546:169;;;;:::o;1721:160::-;1861:12;1857:1;1849:6;1845:14;1838:36;1721:160;:::o;1887:366::-;2029:3;2050:67;2114:2;2109:3;2050:67;:::i;:::-;2043:74;;2126:93;2215:3;2126:93;:::i;:::-;2244:2;2239:3;2235:12;2228:19;;1887:366;;;:::o;2259:419::-;2425:4;2463:2;2452:9;2448:18;2440:26;;2512:9;2506:4;2502:20;2498:1;2487:9;2483:17;2476:47;2540:131;2666:4;2540:131;:::i;:::-;2532:139;;2259:419;;;:::o;2684:164::-;2824:16;2820:1;2812:6;2808:14;2801:40;2684:164;:::o;2854:366::-;2996:3;3017:67;3081:2;3076:3;3017:67;:::i;:::-;3010:74;;3093:93;3182:3;3093:93;:::i;:::-;3211:2;3206:3;3202:12;3195:19;;2854:366;;;:::o;3226:419::-;3392:4;3430:2;3419:9;3415:18;3407:26;;3479:9;3473:4;3469:20;3465:1;3454:9;3450:17;3443:47;3507:131;3633:4;3507:131;:::i;:::-;3499:139;;3226:419;;;:::o","linkReferences":{}},"methodIdentifiers":{"attack()":"9e5faafc","getBalance()":"12065fe0","owner()":"8da5cb5b","target()":"d4b83992"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.30+commit.73712a01\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address payable\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"address payable\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"title\":\"AttackForce\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"attack()\":{\"notice\":\"\\u81ea\\u6bc1\\u5e76\\u5c06\\u6240\\u6709 ETH \\u53d1\\u9001\\u5230\\u76ee\\u6807\\u5730\\u5740 EVM \\u6267\\u884c\\u6d41\\u7a0b\\uff1a 1. SELFDESTRUCT \\u64cd\\u4f5c\\u7801\\u76f4\\u63a5\\u4fee\\u6539\\u76ee\\u6807\\u5730\\u5740\\u7684 balance 2. \\u4e0d\\u8c03\\u7528\\u76ee\\u6807\\u7684 receive/fallback\\uff0c\\u65e0\\u6cd5\\u88ab\\u62d2\\u7edd 3. \\u6807\\u8bb0\\u5f53\\u524d\\u5408\\u7ea6\\u4e3a\\u5f85\\u5220\\u9664\\uff0c\\u5728\\u4ea4\\u6613\\u7ed3\\u675f\\u65f6\\u5220\\u9664\\u5408\\u7ea6\\u4ee3\\u7801\"},\"getBalance()\":{\"notice\":\"\\u67e5\\u770b\\u5408\\u7ea6\\u4f59\\u989d\"}},\"notice\":\"\\u901a\\u8fc7 selfdestruct \\u5f3a\\u5236\\u5411 Force \\u5408\\u7ea6\\u53d1\\u9001 ETH \\u539f\\u7406\\uff1a selfdestruct \\u4f1a\\u5728 EVM \\u5c42\\u9762\\u76f4\\u63a5\\u8f6c\\u79fb\\u4f59\\u989d\\uff0c\\u4e0d\\u89e6\\u53d1\\u76ee\\u6807\\u5408\\u7ea6\\u7684\\u4efb\\u4f55\\u4ee3\\u7801 \\u56e0\\u6b64\\u5373\\u4f7f\\u76ee\\u6807\\u5408\\u7ea6\\u6ca1\\u6709 receive/fallback\\uff0c\\u4e5f\\u80fd\\u5f3a\\u5236\\u63a5\\u6536 ETH forge create src/08-Force/AttackForce.sol:AttackForce \\\\ --rpc-url $sepolia_rpc \\\\ --private-key $PRIVATE_KEY \\\\ --broadcast \\\\ --constructor-args $Force_ADDRESS\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/08-Force/AttackForce.sol\":\"AttackForce\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts@3.4.0/=lib/openzeppelin-contracts3.4.0/contracts/\",\":@openzeppelin/contracts@v4.9.0/=lib/openzeppelin-contractsv4.9.0/contracts/\",\":ds-test/=lib/openzeppelin-contractsv4.9.0/lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contractsv4.9.0/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":halmos-cheatcodes/=lib/openzeppelin-contractsv4.9.0/lib/halmos-cheatcodes/src/\",\":openzeppelin-contracts-06/=lib/openzeppelin-contracts3.4.0/contracts/\",\":openzeppelin-contracts-08/=lib/openzeppelin-contractsv4.9.0/contracts/\",\":openzeppelin-contracts3.4.0/=lib/openzeppelin-contracts3.4.0/contracts/\",\":openzeppelin-contractsv4.9.0/=lib/openzeppelin-contractsv4.9.0/\",\":openzeppelin/=lib/openzeppelin-contractsv4.9.0/contracts/\"]},\"sources\":{\"src/08-Force/AttackForce.sol\":{\"keccak256\":\"0x95c9572dbc34e58cd078861e7945056543c4030c32d606b3880171342e0bea49\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://cf1c78c4468e973c281906eacb9c450131f8a08a4a43925cd99c93d9cfef9b2e\",\"dweb:/ipfs/QmeUvLhSEq3b8wi9JNePrrEpDHzvDUpJP1Yy2wKA3xqZtS\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.30+commit.73712a01"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address payable","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"nonpayable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"target","outputs":[{"internalType":"address payable","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{"attack()":{"notice":"自毁并将所有 ETH 发送到目标地址 EVM 执行流程： 1. SELFDESTRUCT 操作码直接修改目标地址的 balance 2. 不调用目标的 receive/fallback，无法被拒绝 3. 标记当前合约为待删除，在交易结束时删除合约代码"},"getBalance()":{"notice":"查看合约余额"}},"version":1}},"settings":{"remappings":["@openzeppelin/contracts@3.4.0/=lib/openzeppelin-contracts3.4.0/contracts/","@openzeppelin/contracts@v4.9.0/=lib/openzeppelin-contractsv4.9.0/contracts/","ds-test/=lib/openzeppelin-contractsv4.9.0/lib/forge-std/lib/ds-test/src/","erc4626-tests/=lib/openzeppelin-contractsv4.9.0/lib/erc4626-tests/","forge-std/=lib/forge-std/src/","halmos-cheatcodes/=lib/openzeppelin-contractsv4.9.0/lib/halmos-cheatcodes/src/","openzeppelin-contracts-06/=lib/openzeppelin-contracts3.4.0/contracts/","openzeppelin-contracts-08/=lib/openzeppelin-contractsv4.9.0/contracts/","openzeppelin-contracts3.4.0/=lib/openzeppelin-contracts3.4.0/contracts/","openzeppelin-contractsv4.9.0/=lib/openzeppelin-contractsv4.9.0/","openzeppelin/=lib/openzeppelin-contractsv4.9.0/contracts/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/08-Force/AttackForce.sol":"AttackForce"},"evmVersion":"prague","libraries":{}},"sources":{"src/08-Force/AttackForce.sol":{"keccak256":"0x95c9572dbc34e58cd078861e7945056543c4030c32d606b3880171342e0bea49","urls":["bzz-raw://cf1c78c4468e973c281906eacb9c450131f8a08a4a43925cd99c93d9cfef9b2e","dweb:/ipfs/QmeUvLhSEq3b8wi9JNePrrEpDHzvDUpJP1Yy2wKA3xqZtS"],"license":"MIT"}},"version":1},"id":28}